- name: Create a new MBR label on the disk, along with the boot partition
  parted:
    device: "/dev/{{ lfs.root_dev }}"
    label: msdos
    state: present
    number: 1
    part_end: 100MiB
    unit: 'KiB'
  register: part_info
- debug:
    var: part_info


- name: Create the root partition
  parted:
    device: "/dev/{{ lfs.root_dev }}"
    state: present
    number: 2
    part_start: "{{part_info.partitions.0.end}}KiB"
    part_end: 100%


- name: Format the boot partition
  filesystem:
    dev: "/dev/{{ lfs.root_dev }}1"
    fstype: ext4


- name: Format the root partition
  filesystem:
    dev: "/dev/{{ lfs.root_dev }}2"
    fstype: ext4


- name: Mount the root partition
  mount:
    path: "{{ lfs.mnt_dir }}"
    src: "/dev/{{ lfs.root_dev }}2"
    fstype: ext4
    state: mounted
    # path: "{{ lfs_root }}"


- name: Mount the boot partition
  mount:
    path: "{{ lfs.mnt_dir }}/boot"
    src: "/dev/{{ lfs.root_dev }}1"
    fstype: ext4
    state: mounted
    # path: "{{ lfs_root }}/boot"

